package com.hereliesaz.halfhashedkitty

import kotlinx.serialization.Serializable

// --- Local UI Models ---

@Serializable
data class HashModeInfo(
    val mode: String,
    val name: String
) {
    init {
        require(isValidMode(mode)) { "Invalid mode: $mode" }
    }

    companion object {
        val VALID_MODES = setOf(
            "0", "10", "11", "12", "20", "21", "22", "23", "30", "40", "50", "60", "100", "101", "110",
            "111", "112", "120", "121", "122", "124", "125", "130", "131", "132", "133", "140", "141",
            "150", "160", "200", "300", "400", "500", "501", "600", "900", "1000", "1100", "1300",
            "1400", "1410", "1411", "1420", "1421", "1430", "1440", "1441", "1450", "1460", "1500",
            "1600", "1700", "1710", "1711", "1720", "1722", "1730", "1731", "1740", "1750", "1760",
            "1800", "2000", "2100", "2400", "2410", "2500", "2501", "2600", "2611", "2612", "2711",
            "2811", "3000", "3100", "3200", "3710", "3711", "3800", "3910", "4010", "4110", "4300",
            "4400", "4500", "4520", "4521", "4522", "4700", "4710", "4711", "4800", "4900", "5100",
            "5200", "5300", "5400", "5500", "5600", "5700", "5800", "6000", "6100", "6211", "6212",
            "6213", "6221", "6222", "6223", "6231", "6232", "6233", "6241", "6242", "6243", "6300",
            "6400", "6500", "6600", "6700", "6800", "6900", "7000", "7100", "7200", "7300", "7400",
            "7401", "7500", "7700", "7701", "7800", "7801", "7900", "8000", "8100", "8200", "8300",
            "8400", "8500", "8600", "8700", "8800", "8900", "9000", "9100", "9200", "9300", "9400",
            "9500", "9600", "9700", "9710", "9720", "9800", "9810", "9820", "9900", "10000",
            "10100", "10200", "10300", "10400", "10410", "10420", "10500", "10600", "10700",
            "10800", "10900", "10901", "11000", "11100", "11200", "11300", "11400", "11500",
            "11600", "11700", "11750", "11760", "11800", "11850", "11860", "11900", "12000",
            "12001", "12100", "12200", "12300", "12400", "12500", "12600", "12700", "12800",
            "12900", "13000", "13100", "13200", "13300", "13400", "13500", "13600", "13711",
            "13712", "13713", "13721", "13722", "13723", "13731", "13732", "13733", "13741",
            "13742", "13743", "13751", "13752", "13753", "13761", "13762", "13763", "13771",
            "13772", "13773", "13800", "13900", "14000", "14100", "14400", "14600", "14700",
            "14800", "14900", "15000", "15100", "15200", "15300", "15400", "15500", "15600",
            "15700", "15900", "16000", "16100", "16200", "16300", "16400", "16500", "16600",
            "16700", "16800", "16801", "16900", "17200", "17210", "17220", "17225", "17230",
            "17300", "17400", "17500", "17600", "17700", "17800", "17900", "18000", "18100",
            "18200", "18300", "18400", "18500", "18600", "18700", "18800", "18900", "19000",
            "19100", "19200", "19300", "19500", "19600", "19700", "19800", "19900", "20011",
            "20012", "20013", "20200", "20300", "20400", "20500", "20510", "20600", "20710",
            "20711", "20800", "20900", "21000", "21100", "21200", "21300", "21400", "21500",
            "21600", "21700", "21800", "22000", "22001", "22100", "22200", "22300", "22301",
            "22400", "22500", "22600", "22700", "23001", "23002", "23003", "99999"
        )

        fun isValidMode(mode: String): Boolean {
            return VALID_MODES.contains(mode)
        }
    }
}

@Serializable
data class AttackMode(
    val id: Int,
    val name: String
)

// --- WebSocket Communication Models ---

@Serializable
data class WebSocketMessage(
    val type: String,
    val payload: String, // Payload is always a JSON string
    val room_id: String
)

@Serializable
data class AttackParams(
    val jobId: String,
    val file: String,
    val mode: String,
    val attackMode: String,
    val wordlist: String,
    val rules: String? = null
)

@Serializable
data class StatusUpdatePayload(
    val jobId: String,
    val status: String,
    val output: String? = null,
    val error: String? = null
)

@Serializable
data class RoomInfo(
    val type: String,
    val id: String
)